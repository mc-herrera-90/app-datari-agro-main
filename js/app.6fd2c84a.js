(function(e){function t(t){for(var r,o,i=t[0],l=t[1],c=t[2],u=0,d=[];u<i.length;u++)o=i[u],Object.prototype.hasOwnProperty.call(n,o)&&n[o]&&d.push(n[o][0]),n[o]=0;for(r in l)Object.prototype.hasOwnProperty.call(l,r)&&(e[r]=l[r]);m&&m(t);while(d.length)d.shift()();return s.push.apply(s,c||[]),a()}function a(){for(var e,t=0;t<s.length;t++){for(var a=s[t],r=!0,o=1;o<a.length;o++){var i=a[o];0!==n[i]&&(r=!1)}r&&(s.splice(t--,1),e=l(l.s=a[0]))}return e}var r={},o={app:0},n={app:0},s=[];function i(e){return l.p+"js/"+({about:"about"}[e]||e)+"."+{about:"1358cba8","chunk-e5292dc0":"b27b30f1"}[e]+".js"}function l(t){if(r[t])return r[t].exports;var a=r[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,l),a.l=!0,a.exports}l.e=function(e){var t=[],a={about:1,"chunk-e5292dc0":1};o[e]?t.push(o[e]):0!==o[e]&&a[e]&&t.push(o[e]=new Promise((function(t,a){for(var r="css/"+({about:"about"}[e]||e)+"."+{about:"becaef65","chunk-e5292dc0":"6c5eb18d"}[e]+".css",n=l.p+r,s=document.getElementsByTagName("link"),i=0;i<s.length;i++){var c=s[i],u=c.getAttribute("data-href")||c.getAttribute("href");if("stylesheet"===c.rel&&(u===r||u===n))return t()}var d=document.getElementsByTagName("style");for(i=0;i<d.length;i++){c=d[i],u=c.getAttribute("data-href");if(u===r||u===n)return t()}var m=document.createElement("link");m.rel="stylesheet",m.type="text/css",m.onload=t,m.onerror=function(t){var r=t&&t.target&&t.target.src||n,s=new Error("Loading CSS chunk "+e+" failed.\n("+r+")");s.code="CSS_CHUNK_LOAD_FAILED",s.request=r,delete o[e],m.parentNode.removeChild(m),a(s)},m.href=n;var p=document.getElementsByTagName("head")[0];p.appendChild(m)})).then((function(){o[e]=0})));var r=n[e];if(0!==r)if(r)t.push(r[2]);else{var s=new Promise((function(t,a){r=n[e]=[t,a]}));t.push(r[2]=s);var c,u=document.createElement("script");u.charset="utf-8",u.timeout=120,l.nc&&u.setAttribute("nonce",l.nc),u.src=i(e);var d=new Error;c=function(t){u.onerror=u.onload=null,clearTimeout(m);var a=n[e];if(0!==a){if(a){var r=t&&("load"===t.type?"missing":t.type),o=t&&t.target&&t.target.src;d.message="Loading chunk "+e+" failed.\n("+r+": "+o+")",d.name="ChunkLoadError",d.type=r,d.request=o,a[1](d)}n[e]=void 0}};var m=setTimeout((function(){c({type:"timeout",target:u})}),12e4);u.onerror=u.onload=c,document.head.appendChild(u)}return Promise.all(t)},l.m=e,l.c=r,l.d=function(e,t,a){l.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},l.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},l.t=function(e,t){if(1&t&&(e=l(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(l.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)l.d(a,r,function(t){return e[t]}.bind(null,r));return a},l.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return l.d(t,"a",t),t},l.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},l.p="/",l.oe=function(e){throw console.error(e),e};var c=window["webpackJsonp"]=window["webpackJsonp"]||[],u=c.push.bind(c);c.push=t,c=c.slice();for(var d=0;d<c.length;d++)t(c[d]);var m=u;s.push([0,"chunk-vendors"]),a()})({0:function(e,t,a){e.exports=a("56d7")},"4a89":function(e,t,a){"use strict";a("9eee")},"56d7":function(e,t,a){"use strict";a.r(t);var r=a("2b0e"),o=function(){var e=this,t=e._self._c;return t("router-view")},n=[],s={name:"App",data:()=>({menulateral:!0}),created(){this.$http.interceptors.response.use(void 0,(function(e){return new Promise((function(t,a){throw 401===e.status&&e.config&&!e.config.__isRetryRequest&&this.$store.dispatch(logout),e}))}))}},i=s,l=a("2877"),c=Object(l["a"])(i,o,n,!1,null,null,null),u=c.exports,d=(a("0643"),a("9a9a"),a("fffc"),a("2f62")),m=a("bc3a"),p=a.n(m);const h="https://api.agro.datari.site";r["a"].use(d["a"]);var f=new d["a"].Store({state:{status:null,token:localStorage.getItem("token")||"",user:{},selectProducer:parseInt(localStorage.getItem("selectedProducer"),10)||null,generalData:{},producers:[{id:1,nombre:"1"},{id:2,nombre:"2"},{id:3,nombre:"3"},{id:4,nombre:"4"},{id:5,nombre:"5"},{id:6,nombre:"6"},{id:7,nombre:"7"},{id:8,nombre:"Admin"}]},mutations:{auth_request(e){e.status="loading"},auth_success(e,t,a){e.status="success",e.token=t,e.user=a},auth_error(e){e.status="error"},logout(e){e.status="",e.token=""},setSelectedProducer(e,t){e.selectedProducer=t},setGeneralData(e,t){e.generalData=t}},actions:{login({commit:e},t){return new Promise((a,r)=>{e("auth_request"),p()({url:h+"/auth/login/",data:t,method:"POST"}).then(t=>{const r=t.data.access_token,o=t.data.user;p.a.defaults.headers.common["Authorization"]="Bearer "+r,localStorage.setItem("token",r),localStorage.setItem("username",o.username),localStorage.setItem("user_id",o.pk),localStorage.setItem("user_role",o.is_staff?"admin":"user"),localStorage.setItem("user_superuser",o.is_superuser?"si":"no"),e("auth_success",r,o),a(t)}).catch(t=>{e("auth_error"),localStorage.removeItem("token"),localStorage.removeItem("user"),delete p.a.defaults.headers.common["Authorization"],r(t)})})},logout({commit:e}){return new Promise(t=>{e("logout"),localStorage.removeItem("token"),localStorage.removeItem("user_role"),localStorage.removeItem("user_superuser"),localStorage.removeItem("token"),localStorage.removeItem("username"),localStorage.removeItem("user_id"),t()})},updateSelectedProducer({commit:e},t){e("setSelectedProducer",t)},async fetchGeneralData({commit:e},t){try{p.a.defaults.headers.common["Authorization"]="Bearer "+this.state.token;const a=await p.a.get(`${h}/api/productores/${t}/`);e("setGeneralData",a.data),localStorage.setItem("selectedProducer",t),console.log(a.data)}catch(a){console.error("Error al cargar los datos:",a)}}},getters:{isLoggedIn:e=>!!e.token,authStatus:e=>e.status,get_user:e=>e.user,getGeneralData:e=>e.generalData,selectedProducer:e=>e.producers.find(t=>t.id===e.selectedProducer)}}),g=a("8c4f"),b=a("7496"),v=a("40dc"),_=a("5bc1"),y=a("8336"),w=a("a523"),k=a("553a"),x=a("132d"),S=a("adda"),C=a("8860"),I=a("da13"),P=a("8270"),D=a("5d23"),j=a("f6c4"),A=a("f774"),O=a("b974"),L=a("2fa4"),$=a("2a7f"),E=function(){var e=this,t=e._self._c;return t(b["a"],{attrs:{id:"dash"}},[t(v["a"],{attrs:{app:"",dark:"",elevation:"0","clipped-left":"",color:"blue darken-4"}},[t(_["a"],{on:{click:function(t){t.stopPropagation(),e.menulateral=!e.menulateral}}}),t($["a"],[t("div",{staticClass:"d-flex align-center"},[t(S["a"],{staticClass:"shrink",attrs:{alt:"labict logo",contain:"",src:a("78d4"),transition:"scale-transition",width:"120",height:"30"}})],1)]),t(L["a"]),t(x["a"],[e._v("mdi-account")]),t("span",{staticClass:"ml-1 mr-2"},[e._v(e._s(e.user))]),e.isLoggedIn?t(y["a"],{attrs:{text:""},on:{click:e.logout}},[t(x["a"],[e._v("mdi-power-cycle")])],1):e._e()],1),t(A["a"],{style:{zIndex:"1"},attrs:{floating:"",app:"",permanent:e.menulateral,clipped:"",dark:"",color:"blue darken-3"},model:{value:e.menulateral,callback:function(t){e.menulateral=t},expression:"menulateral"}},[t(C["a"],{staticClass:"d-flex flex-column",attrs:{nav:""}},[t(I["a"],{attrs:{link:"",to:{path:"/"},"active-class":"white--text blue darken-3"}},[t(P["a"],[t(x["a"],[e._v("mdi-home-outline")])],1),t(D["a"],[t("h4",{staticClass:"font-weight-medium"},[e._v("Home")])])],1),t(I["a"],{attrs:{link:"",to:{path:"/caracterizacion/"},"active-class":"white--text blue darken-3"}},[t(P["a"],[t(x["a"],[e._v("mdi-file-plus-outline")])],1),t(D["a"],[t("h4",{staticClass:"font-weight-medium"},[e._v("Resultados Generales")])])],1),"admin"===e.userRole?t("div",[t(D["a"],[t(O["a"],{attrs:{label:"Productor",items:e.producers,"item-value":"id","item-text":"nombre",outlined:""},on:{change:e.handleProducerChange},model:{value:e.selectedProducer,callback:function(t){e.selectedProducer=t},expression:"selectedProducer"}})],1)],1):t("div",[t(I["a"],{staticClass:"px-0",attrs:{link:"",to:{path:"/detallesencuesta/"+e.userId},"active-class":"white--text blue darken-3"}},[t(P["a"],[t(x["a"],[e._v("mdi-file-outline")])],1),t(D["a"],[t("h4",{staticClass:"font-weight-medium"},[e._v("Mis Resultados")])])],1)],1)],1)],1),t(j["a"],{staticStyle:{"background-color":"#D5D8DC"},attrs:{id:"main-content"}},[t(w["a"],{attrs:{fluid:"",transition:"fade-transition",id:"inside-content"}},[t("router-view",{attrs:{loading:e.loading}})],1)],1),t(k["a"],{staticStyle:{height:"5vh"},attrs:{dark:"",app:"",padless:""}},[t("span",{staticClass:"white--text ml-2"},[t("small",[e._v("LAB ICT © "+e._s((new Date).getFullYear()))])])])],1)},T=[],z=(a("14d9"),{name:"Dashboard",data:()=>({producers:[{id:1,nombre:"Prod 1"},{id:2,nombre:"Prod 2"},{id:3,nombre:"Prod 3"},{id:4,nombre:"Prod 4"},{id:5,nombre:"Prod 5"},{id:6,nombre:"Prod 6"},{id:7,nombre:"Prod 7"}],userId:localStorage.getItem("user_id"),userRole:localStorage.getItem("user_role"),menulateral:!0,loading:!1,user:localStorage.getItem("username")}),computed:{...Object(d["c"])(["selectedProducer"]),isLoggedIn(){return this.$store.getters.isLoggedIn}},methods:{...Object(d["b"])(["updateSelectedProducer","fetchGeneralData"]),handleProducerChange(e){this.updateSelectedProducer(e),this.fetchGeneralData(e).then(()=>{this.$router.push({path:"/detallesencuesta/"+e})})},logout(){this.$store.dispatch("logout").then(()=>{this.$router.push("/login")})}}}),B=z,q=(a("4a89"),Object(l["a"])(B,E,T,!1,null,"68dfec98",null)),G=q.exports,N=a("0798"),R=a("b0af"),M=a("99d9"),V=a("0e8f"),F=a("4bd4"),H=a("a722"),J=a("490a"),U=a("8654"),Y=function(){var e=this,t=e._self._c;return t(b["a"],{attrs:{id:"login"}},[t(j["a"],{staticStyle:{"background-color":"#D5D8DC"}},[t(w["a"],{attrs:{"fill-height":""}},[t(H["a"],{attrs:{"align-center":"","justify-center":""}},[t(V["a"],{staticClass:"text-center display-1 mb-3",staticStyle:{"max-width":"400px"}},[t(R["a"],{attrs:{dark:"",color:"white",elevation:"6",height:"430"}},[t(M["b"],{staticClass:"subheading"},[t(S["a"],{staticClass:"mx-auto mt-8",attrs:{"max-height":"50","max-width":"220",src:a("aba7"),transition:"fade"}}),t("div",{staticStyle:{width:"90%",margin:"0 auto"}},[t(F["a"],{ref:"form",staticClass:"mt-12",on:{submit:function(t){return t.preventDefault(),e.login.apply(null,arguments)}}},[t(U["a"],{attrs:{light:"","prepend-icon":"mdi-account",label:"Usuario",type:"text",rules:[e=>!!e||"Ingrese un nombre de usuario"]},model:{value:e.username,callback:function(t){e.username=t},expression:"username"}}),t(U["a"],{staticClass:"mt-4",attrs:{light:"","prepend-icon":"mdi-lock",label:"Contraseña",type:"password",rules:[e=>!!e||"Ingrese una contraseña"]},model:{value:e.password,callback:function(t){e.password=t},expression:"password"}}),t("div",{staticStyle:{"margin-top":"20px"}},[e.loading?t("div",[t(J["a"],{attrs:{size:40,color:"blue",indeterminate:""}})],1):t("div",[t(y["a"],{attrs:{color:"#1565C0",block:"",dark:"",type:"submit",transition:"fade-transition"}},[e._v(" Iniciar Sesión ")])],1)]),t("div",{staticClass:"mt-4",attrs:{id:"alertas"}},[e.login_succesful?t("div",[t(N["a"],{staticClass:"text-left",attrs:{type:"success",value:e.login_succesful,transition:"fade-transition",dense:""}},[e._v(" Credenciales Validas ")])],1):e._e(),e.error_credenciales?t("div",[t(N["a"],{staticClass:"text-left",attrs:{type:"error",value:e.error_credenciales,transition:"fade-transition",dense:""}},[e._v(" Credenciales incorrectasa ")])],1):e._e()])],1)],1)],1)],1)],1)],1)],1)],1)],1)},K=[],Q={name:"Login",data(){return{username:null,password:null,login_succesful:!1,loading:!1,error_credenciales:!1,options:{shouldStayLoggedIn:!0}}},methods:{login(){if(this.$refs.form.validate(),null!=this.username&&null!=this.password){this.error_credenciales=!1,this.loading=!0;let e=this.username,t=this.password;this.$refs.form.validate(),this.$store.dispatch("login",{username:e,password:t}).then(()=>{this.error_credenciales=!1,this.sleep(3e3).then(()=>{this.loading=!1,this.login_succesful=!0,this.sleep(2e3).then(()=>{this.$router.push({path:"/"})})})}).catch(e=>{this.error_credenciales=!0,this.login_succesful=!1,this.loading=!1})}},sleep(e){return new Promise(t=>setTimeout(t,e))}}},W=Q,X=Object(l["a"])(W,Y,K,!1,null,null,null),Z=X.exports,ee=a("62ad"),te=a("0fd9"),ae=function(){var e=this,t=e._self._c;return t(b["a"],{attrs:{id:"index"}},[t(j["a"],{staticStyle:{"background-color":"#1565C0"}},[t(w["a"],{attrs:{"fill-height":""}},[t(H["a"],{attrs:{"align-center":"","justify-center":""}},[t("div",[t("div",[t(S["a"],{attrs:{"max-height":"50","max-width":"220",src:a("78d4"),transition:"fade"}})],1),t("div",{staticClass:"mt-8 mb-14 text-center"},[t(J["a"],{attrs:{size:60,color:"white",indeterminate:""}})],1),t("div",{staticClass:"mt-4 ml-16"},[t(te["a"],[t(ee["a"],{attrs:{cols:"4"}},[t(S["a"],{attrs:{"max-height":"80","max-width":"25",src:a("a71e"),transition:"fade"}})],1),t(ee["a"],{attrs:{cols:"8"}},[t("h3",{staticClass:"white--text font-weight-medium mt-0",staticStyle:{"margin-left":"-35px"}},[e._v(" LAB-ICT ")])])],1)],1)])])],1)],1),t(k["a"],{staticClass:"justify-center",staticStyle:{"background-color":"#1565C0"},attrs:{dark:"",app:""}},[t("div",[e._v(" "+e._s((new Date).getFullYear())+" — "),t("strong",[e._v("LABICT ©")])])])],1)},re=[],oe={name:"indexView",data(){return{}}},ne=oe,se=Object(l["a"])(ne,ae,re,!1,null,"d08f150e",null),ie=se.exports;a("9f62");r["a"].use(g["a"]);const le=[{path:"/login",name:"Login",component:Z},{path:"/index",name:"Index",component:ie},{path:"/",component:G,props:!0,children:[{path:"",component:()=>a.e("chunk-e5292dc0").then(a.bind(null,"bb51")),props:!0},{path:"caracterizacion/",component:()=>a.e("about").then(a.bind(null,"2622"))},{path:"rating/",component:()=>a.e("about").then(a.bind(null,"36ef"))},{path:"materiaprima/",component:()=>a.e("about").then(a.bind(null,"e6fb"))},{path:"acceso-denegado/",name:"AccesoDenegado",component:()=>a.e("about").then(a.bind(null,"9f62"))},{path:"/detallesencuesta/:producerId",name:"DetallesView",component:()=>a.e("about").then(a.bind(null,"e7d2")),props:!0,beforeEnter:(e,t,a)=>{const r=e.params.producerId;f.dispatch("updateSelectedProducer",r).then(()=>{a()}).catch(e=>{console.error("Error al actualizar el producerId:",e),a(!1)})}}],meta:{requiresAuth:!0}}],ce=new g["a"]({mode:"history",base:"/",routes:le});ce.beforeEach((e,t,a)=>{if(e.matched.some(e=>e.meta.requiresAuth)){if(f.getters.isLoggedIn)return void a();a("/login")}else a()});var ue=ce,de=a("f309");r["a"].use(de["a"]);var me=new de["a"]({}),pe=a("1321"),he=a.n(pe);r["a"].component("apexchart",he.a),r["a"].config.productionTip=!0,r["a"].prototype.$http=p.a;const fe=localStorage.getItem("token");fe&&(r["a"].prototype.$http.defaults.headers.common["Authorization"]="Bearer "+fe),new r["a"]({router:ue,store:f,vuetify:me,render:e=>e(u)}).$mount("#app")},"78d4":function(e,t,a){e.exports=a.p+"img/logo_blanco.2003aa00.png"},"9eee":function(e,t,a){},"9f62":function(e,t,a){"use strict";a.r(t);var r=a("8336"),o=(a("14d9"),function(){var e=this,t=e._self._c;return t("div",{staticClass:"text-center"},[t("h1",[e._v("Acceso Denegado")]),t("p",[e._v("No tiene permiso para acceder a esta vista.")]),t(r["a"],{attrs:{color:"primary"},on:{click:function(t){return e.$router.push("/")}}},[e._v("Volver al Inicio")])],1)}),n=[],s={name:"AccesoDenegado"},i=s,l=a("2877"),c=Object(l["a"])(i,o,n,!1,null,null,null);t["default"]=c.exports},a71e:function(e,t,a){e.exports=a.p+"img/logo_lab.90d1b781.png"},aba7:function(e,t,a){e.exports=a.p+"img/logo_azul.ee3d07af.png"}});
//# sourceMappingURL=app.6fd2c84a.js.map